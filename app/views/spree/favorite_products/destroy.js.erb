<% if @success %>
  if($('.favorite_link').length) {
    $('.favorite_link').attr('href', '<%= favorite_products_path(:id => @favorite.product_id) %>')
                       .data('method', 'post')
                       .html('<%= '<i class="fa fa-gift" aria-hidden="true"></i> '.html_safe + Spree.t(:mark_as_favorite) %>')
    <%= ajax_flash_message("success", Spree.t(:success, scope: [:favorite_products, :destroy])) %>
  } else {
    $("#favorite_product_<%= @favorite.product_id%>").remove();
    <%= ajax_flash_message("success", Spree.t(:success, scope: [:favorite_products, :destroy])) %>
    if (!$('.favorite_product').length) {
      window.location = '<%= favorite_products_path %>'
    }
  }
  
  // decrease the number of saved products
  var favorites = parseInt($('.favorite-items').html())
  favorites--
  if(favorites) {
    $('.favorite-items').html(favorites)
  } else {
    $('.favorite-items').remove()
  }
<% else %>
  <%= ajax_flash_message("error", Spree.t(:error, scope: [:favorite_products, :destroy])) %>
<% end %>
